<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CLAT PG Mock Test 2026</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .card {
            background: white;
            border-radius: 16px;
            padding: 32px;
            margin-bottom: 24px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 32px;
        }
        
        .header h1 {
            font-size: 42px;
            font-weight: 700;
            margin-bottom: 8px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
        }
        
        input, select {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 15px;
            transition: all 0.3s;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 14px 28px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }
        
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        
        .btn-delete {
            background: linear-gradient(135deg, #ff0844 0%, #ffb199 100%);
        }
        
        .qr-container {
            text-align: center;
            padding: 24px;
            background: #f8f9fa;
            border-radius: 12px;
            margin: 24px 0;
        }
        
        .qr-code {
            max-width: 350px;
            width: 100%;
            height: auto;
            border: 3px solid #667eea;
            border-radius: 12px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
        }
        
        .hidden {
            display: none !important;
        }
        
        .timer {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 16px 24px;
            border-radius: 12px;
            font-size: 20px;
            font-weight: 700;
            color: #667eea;
            box-shadow: 0 8px 24px rgba(0,0,0,0.2);
            z-index: 1000;
        }
        
        .timer.warning {
            background: #ff4757;
            color: white;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .question-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 32px;
            margin-bottom: 24px;
        }
        
        .question-number {
            color: #667eea;
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 20px;
        }
        
        .passage-box {
            background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
            padding: 24px;
            border-radius: 12px;
            margin: 24px 0;
            border-left: 5px solid #fdcb6e;
        }
        
        .passage-box p {
            line-height: 1.8;
            color: #2d3436;
            font-size: 16px;
        }
        
        .question-text {
            font-size: 18px;
            font-weight: 600;
            margin: 24px 0;
            color: #2d3436;
        }
        
        .option-label {
            display: flex;
            align-items: flex-start;
            padding: 18px;
            margin-bottom: 14px;
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .option-label:hover {
            border-color: #667eea;
            background: #f0f3ff;
            transform: translateX(4px);
        }
        
        .option-label.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
            border-width: 3px;
        }
        
        .option-label input[type="radio"] {
            width: 20px;
            height: 20px;
            margin-right: 12px;
            cursor: pointer;
        }
        
        .question-palette {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(50px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }
        
        .palette-btn {
            padding: 12px;
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .palette-btn:hover {
            background: #e9ecef;
        }
        
        .palette-btn.answered {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border-color: #4facfe;
        }
        
        .palette-btn.current {
            border: 3px solid #667eea;
            background: #667eea;
            color: white;
        }
        
        .user-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            margin-bottom: 16px;
            border-radius: 12px;
            border-left: 5px solid #667eea;
        }
        
        .status-badge {
            display: inline-block;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
        }
        
        .status-paid {
            background: #00f2fe;
            color: white;
        }
        
        .status-pending {
            background: #f5576c;
            color: white;
        }
        
        .admin-actions {
            display: flex;
            gap: 10px;
            margin-top: 16px;
        }
        
        .admin-actions button {
            flex: 1;
        }
        
        .question-nav {
            display: flex;
            gap: 16px;
            margin-top: 24px;
        }
        
        .question-nav button {
            flex: 1;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Login Screen -->
        <div id="loginScreen">
            <div class="header">
                <h1>üéì CLAT PG Mock Test 2026</h1>
                <p style="font-size: 18px;">Common Law Admission Test - Postgraduate</p>
            </div>
            <div class="card">
                <h2 style="text-align: center; margin-bottom: 24px; color: #667eea;">üîê Login</h2>
                <form id="loginForm">
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="loginEmail" required>
                    </div>
                    <div class="form-group">
                        <label>Password</label>
                        <input type="password" id="loginPassword" required>
                    </div>
                    <button type="submit" style="width: 100%;">Login</button>
                </form>
                <div style="text-align: center; margin-top: 20px;">
                    <a href="#" id="showRegister" style="color: #667eea; font-weight: 600;">Don't have an account? Register here</a>
                </div>
                <div style="text-align: center; margin-top: 12px;">
                    <a href="#" id="showAdminLogin" style="color: #999; font-size: 13px;">Admin Login</a>
                </div>
            </div>
        </div>

        <!-- Register Screen -->
        <div id="registerScreen" class="hidden">
            <div class="header">
                <h1>üìù Register</h1>
            </div>
            <div class="card">
                <form id="registerForm">
                    <div class="form-group">
                        <label>Full Name</label>
                        <input type="text" id="regName" required>
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="regEmail" required>
                    </div>
                    <div class="form-group">
                        <label>Phone Number</label>
                        <input type="tel" id="regPhone" required pattern="[0-9]{10}">
                    </div>
                    <div class="form-group">
                        <label>Password (min 6 characters)</label>
                        <input type="password" id="regPassword" required minlength="6">
                    </div>
                    <button type="submit" style="width: 100%;">Continue to Payment</button>
                </form>
                <div style="text-align: center; margin-top: 20px;">
                    <a href="#" id="showLogin" style="color: #667eea; font-weight: 600;">Already have an account? Login here</a>
                </div>
            </div>
        </div>

        <!-- Payment Screen -->
        <div id="paymentScreen" class="hidden">
            <div class="header">
                <h1>üí≥ Payment</h1>
            </div>
            <div class="card">
                <h2 style="text-align: center; color: #667eea; margin-bottom: 24px;">Complete Payment - ‚Çπ50</h2>
                <div class="qr-container">
                    <p style="font-size: 18px; font-weight: 600; margin-bottom: 16px; color: #333;">Scan QR Code to Pay ‚Çπ50</p>
                    <!-- QR CODE WITH MULTIPLE FALLBACK OPTIONS -->
                    <img class="qr-code" 
     src="https://raw.githubusercontent.com/mrnone9897/mrnone9897.github.io/9f661b005b2f669183afe54315ab64361dc06d78/WhatsApp%20Image%202025-11-01%20at%2010.54.33.jpeg" 
     onerror="this.onerror=null; this.src='https://mrnone9897.github.io/WhatsApp%20Image%202025-11-01%20at%2010.54.33.jpeg';" 
     alt="PhonePe Payment QR Code">
                    <p style="margin-top: 16px; color: #666;">Pay ‚Çπ50 via PhonePe/UPI and enter transaction details below</p>
                </div>
                <form id="paymentForm">
                    <div class="form-group">
                        <label>Transaction ID / UPI Reference Number *</label>
                        <input type="text" id="transactionId" required placeholder="Enter 12-digit transaction ID">
                    </div>
                    <div class="form-group">
                        <label>Confirm Name *</label>
                        <input type="text" id="confirmName" required>
                    </div>
                    <div class="form-group">
                        <label>Confirm Email *</label>
                        <input type="email" id="confirmEmail" required>
                    </div>
                    <div class="form-group">
                        <label>Confirm Phone *</label>
                        <input type="tel" id="confirmPhone" required>
                    </div>
                    <button type="submit" style="width: 100%;">Submit & Get Access</button>
                </form>
            </div>
        </div>

        <!-- Admin Login Screen -->
        <div id="adminLoginScreen" class="hidden">
            <div class="header">
                <h1>üîí Admin Login</h1>
            </div>
            <div class="card">
                <form id="adminLoginForm">
                    <div class="form-group">
                        <label>Admin Email</label>
                        <input type="email" id="adminEmail" required>
                    </div>
                    <div class="form-group">
                        <label>Admin Password</label>
                        <input type="password" id="adminPassword" required>
                    </div>
                    <button type="submit" style="width: 100%;">Login as Admin</button>
                </form>
                <div style="text-align: center; margin-top: 20px;">
                    <a href="#" id="backToLogin" style="color: #667eea; font-weight: 600;">Back to User Login</a>
                </div>
            </div>
        </div>

        <!-- Admin Panel -->
        <div id="adminPanel" class="hidden">
            <div class="header">
                <h1>‚öôÔ∏è Admin Panel</h1>
                <button id="adminLogout" style="margin-top: 16px;">Logout</button>
            </div>
            <div class="card">
                <h2 style="color: #667eea; margin-bottom: 24px;">User Management</h2>
                <div id="userList"></div>
            </div>
        </div>

        <!-- Main App Screen -->
        <div id="mainScreen" class="hidden">
            <div class="header">
                <h1>CLAT PG Mock Test 2026</h1>
                <p id="welcomeUser" style="font-size: 18px; margin-top: 8px;"></p>
                <button id="logoutBtn" style="margin-top: 16px;">Logout</button>
            </div>

            <!-- Test Selection -->
            <div id="testSelectionScreen" class="card">
                <h2 style="color: #667eea; margin-bottom: 24px;">Select Mock Test</h2>
                <div class="form-group">
                    <select id="testSelector">
                        <optgroup label="üìö Subject-Wise Tests (26)">
                            <option value="1">Test 1: Constitutional Law - Part 1</option>
                            <option value="2">Test 2: Constitutional Law - Part 2</option>
                            <option value="3">Test 3: Criminal Law - Part 1</option>
                            <option value="4">Test 4: Criminal Law - Part 2</option>
                            <option value="5">Test 5: Contract Law - Part 1</option>
                            <option value="6">Test 6: Contract Law - Part 2</option>
                            <option value="7">Test 7: Tort Law - Part 1</option>
                            <option value="8">Test 8: Tort Law - Part 2</option>
                            <option value="9">Test 9: International Law - Part 1</option>
                            <option value="10">Test 10: International Law - Part 2</option>
                            <option value="11">Test 11: IPR - Part 1</option>
                            <option value="12">Test 12: IPR - Part 2</option>
                            <option value="13">Test 13: Jurisprudence - Part 1</option>
                            <option value="14">Test 14: Jurisprudence - Part 2</option>
                            <option value="15">Test 15: Administrative Law</option>
                            <option value="16">Test 16: Family Law</option>
                            <option value="17">Test 17: Property Law</option>
                            <option value="18">Test 18: Company Law</option>
                            <option value="19">Test 19: Tax Law</option>
                            <option value="20">Test 20: Environmental Law</option>
                            <option value="21">Test 21: Labour Law</option>
                            <option value="22">Test 22: Evidence Act</option>
                            <option value="23">Test 23: CPC & Limitation</option>
                            <option value="24">Test 24: Arbitration & ADR</option>
                            <option value="25">Test 25: Banking & Insurance</option>
                            <option value="26">Test 26: Cyber Law</option>
                        </optgroup>
                        <optgroup label="üéØ Full Syllabus Tests (10)">
                            <option value="27">Test 27: Full Syllabus Mock 1</option>
                            <option value="28">Test 28: Full Syllabus Mock 2</option>
                            <option value="29">Test 29: Full Syllabus Mock 3</option>
                            <option value="30">Test 30: Full Syllabus Mock 4</option>
                            <option value="31">Test 31: Full Syllabus Mock 5</option>
                            <option value="32">Test 32: Full Syllabus Mock 6</option>
                            <option value="33">Test 33: Full Syllabus Mock 7</option>
                            <option value="34">Test 34: Full Syllabus Mock 8</option>
                            <option value="35">Test 35: Full Syllabus Mock 9</option>
                            <option value="36">Test 36: Full Syllabus Mock 10</option>
                        </optgroup>
                        <optgroup label="‚öñÔ∏è Latest Judgments (7)">
                            <option value="37">Test 37: 2024-25 SC Judgments 1</option>
                            <option value="38">Test 38: 2024-25 SC Judgments 2</option>
                            <option value="39">Test 39: Constitutional Bench</option>
                            <option value="40">Test 40: Criminal Law Amendments</option>
                            <option value="41">Test 41: Contract & Tort Cases</option>
                            <option value="42">Test 42: International Law</option>
                            <option value="43">Test 43: IPR & Tech Law</option>
                        </optgroup>
                        <optgroup label="üî• Final Revision (7)">
                            <option value="44">Test 44: High-Weightage Topics</option>
                            <option value="45">Test 45: Previous Year Pattern</option>
                            <option value="46">Test 46: Difficult Questions</option>
                            <option value="47">Test 47: Speed & Accuracy</option>
                            <option value="48">Test 48: Grand Mock 1</option>
                            <option value="49">Test 49: Grand Mock 2</option>
                            <option value="50">Test 50: Final Grand Mock</option>
                        </optgroup>
                    </select>
                </div>
                <button id="startTestBtn" style="width: 100%;">Start Test</button>
            </div>

            <!-- Test Screen -->
            <div id="testScreen" class="hidden">
                <div class="timer" id="timer">120:00</div>
                
                <div class="question-card" id="questionCard"></div>

                <div class="question-nav">
                    <button id="prevBtn">‚Üê Previous</button>
                    <button id="submitTestBtn" class="btn-danger">Submit Test</button>
                    <button id="nextBtn">Next ‚Üí</button>
                </div>

                <div class="card">
                    <h3 style="color: #667eea;">Question Palette</h3>
                    <div id="questionPalette" class="question-palette"></div>
                </div>
            </div>

            <!-- Results Screen -->
            <div id="resultsScreen" class="hidden">
                <div class="card">
                    <h2 style="text-align: center; color: #667eea;">Test Results</h2>
                    <div id="resultsContent"></div>
                    <button id="backToTestsBtn" style="width: 100%; margin-top: 24px;">Back to Tests</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const ADMIN_EMAIL = "masi.wal@adminApr2024";
        const ADMIN_PASSWORD_HASH = "f8a3c6c0feb8d04eec7595052a5aab4959d196eb74a4ec5275c192fb635158ba";
        
        let currentUser = null;
        let currentTest = null;
        let currentQuestion = 0;
        let answers = {};
        let timerInterval = null;
        let timeRemaining = 7200;

        document.addEventListener('DOMContentLoaded', init);

        function init() {
            checkLoginStatus();
            attachEventListeners();
        }

        async function sha256(message) {
            const msgBuffer = new TextEncoder().encode(message);
            const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
        }

        function attachEventListeners() {
            document.getElementById('showRegister').addEventListener('click', (e) => { e.preventDefault(); showScreen('registerScreen'); });
            document.getElementById('showLogin').addEventListener('click', (e) => { e.preventDefault(); showScreen('loginScreen'); });
            document.getElementById('showAdminLogin').addEventListener('click', (e) => { e.preventDefault(); showScreen('adminLoginScreen'); });
            document.getElementById('backToLogin').addEventListener('click', (e) => { e.preventDefault(); showScreen('loginScreen'); });
            document.getElementById('loginForm').addEventListener('submit', handleLogin);
            document.getElementById('registerForm').addEventListener('submit', handleRegister);
            document.getElementById('paymentForm').addEventListener('submit', handlePaymentSubmission);
            document.getElementById('adminLoginForm').addEventListener('submit', handleAdminLogin);
            document.getElementById('logoutBtn').addEventListener('click', logout);
            document.getElementById('adminLogout').addEventListener('click', logout);
            document.getElementById('startTestBtn').addEventListener('click', startTest);
            document.getElementById('submitTestBtn').addEventListener('click', submitTest);
            document.getElementById('backToTestsBtn').addEventListener('click', backToTests);
            document.getElementById('nextBtn').addEventListener('click', () => navigateQuestion(1));
            document.getElementById('prevBtn').addEventListener('click', () => navigateQuestion(-1));
        }

        function showScreen(screenId) {
            const screens = ['loginScreen', 'registerScreen', 'paymentScreen', 'adminLoginScreen', 'adminPanel', 'mainScreen'];
            screens.forEach(screen => document.getElementById(screen).classList.add('hidden'));
            document.getElementById(screenId).classList.remove('hidden');
        }

        function checkLoginStatus() {
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                if (currentUser.isAdmin) {
                    loadAdminPanel();
                    showScreen('adminPanel');
                } else {
                    document.getElementById('welcomeUser').textContent = `Welcome, ${currentUser.name}! üéâ`;
                    showScreen('mainScreen');
                }
            }
        }

        function handleLogin(e) {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const users = JSON.parse(localStorage.getItem('users') || '{}');
            const user = users[email];
            
            if (!user) { alert('Invalid credentials. Please register first.'); return; }
            if (user.password !== password) { alert('Invalid password.'); return; }
            if (!user.hasAccess) { alert('Payment pending verification. Contact admin.'); return; }
            
            currentUser = user;
            localStorage.setItem('currentUser', JSON.stringify(user));
            document.getElementById('welcomeUser').textContent = `Welcome, ${user.name}! üéâ`;
            showScreen('mainScreen');
        }

        function handleRegister(e) {
            e.preventDefault();
            const name = document.getElementById('regName').value;
            const email = document.getElementById('regEmail').value;
            const phone = document.getElementById('regPhone').value;
            const password = document.getElementById('regPassword').value;
            const users = JSON.parse(localStorage.getItem('users') || '{}');
            
            if (users[email]) { alert('Email already registered. Please login.'); return; }
            
            const tempUser = { name, email, phone, password };
            localStorage.setItem('tempRegistration', JSON.stringify(tempUser));
            document.getElementById('confirmName').value = name;
            document.getElementById('confirmEmail').value = email;
            document.getElementById('confirmPhone').value = phone;
            showScreen('paymentScreen');
        }

        function handlePaymentSubmission(e) {
            e.preventDefault();
            const transactionId = document.getElementById('transactionId').value;
            const tempUser = JSON.parse(localStorage.getItem('tempRegistration'));
            const users = JSON.parse(localStorage.getItem('users') || '{}');
            
            users[tempUser.email] = {
                ...tempUser,
                transactionId: transactionId,
                paymentDate: new Date().toISOString(),
                hasAccess: true
            };
            
            localStorage.setItem('users', JSON.stringify(users));
            localStorage.removeItem('tempRegistration');
            
            // Send email via Formspree (automatic - no user click needed)
            fetch('https://formspree.io/f/mldoolzv', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    name: tempUser.name,
                    email: tempUser.email,
                    phone: tempUser.phone,
                    transactionId: transactionId,
                    date: new Date().toLocaleString(),
                    _subject: 'New Payment - CLAT PG Mock Test'
                })
            }).catch(err => console.log('Email send failed:', err));
            
            alert('Payment submitted! You now have access to all 50 tests! üéâ');
            currentUser = users[tempUser.email];
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            document.getElementById('welcomeUser').textContent = `Welcome, ${tempUser.name}! üéâ`;
            showScreen('mainScreen');
        }

        async function handleAdminLogin(e) {
            e.preventDefault();
            const email = document.getElementById('adminEmail').value;
            const password = document.getElementById('adminPassword').value;
            const passwordHash = await sha256(password);
            
            if (email === ADMIN_EMAIL && passwordHash === ADMIN_PASSWORD_HASH) {
                currentUser = { isAdmin: true, email: ADMIN_EMAIL };
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                loadAdminPanel();
                showScreen('adminPanel');
            } else {
                alert('Invalid admin credentials!');
            }
        }

        function loadAdminPanel() {
            const users = JSON.parse(localStorage.getItem('users') || '{}');
            const userList = document.getElementById('userList');
            userList.innerHTML = '';
            
            if (Object.keys(users).length === 0) {
                userList.innerHTML = '<p style="text-align: center; color: #999;">No users registered yet.</p>';
                return;
            }
            
            Object.values(users).forEach(user => {
                const div = document.createElement('div');
                div.className = 'user-card';
                div.innerHTML = `
                    <h4 style="color: #667eea; margin-bottom: 12px;">${user.name}</h4>
                    <p><strong>Email:</strong> ${user.email}</p>
                    <p><strong>Phone:</strong> ${user.phone}</p>
                    <p><strong>Transaction ID:</strong> ${user.transactionId || 'N/A'}</p>
                    <p><strong>Date:</strong> ${user.paymentDate ? new Date(user.paymentDate).toLocaleDateString() : 'N/A'}</p>
                    <p><strong>Status:</strong> <span class="status-badge ${user.hasAccess ? 'status-paid' : 'status-pending'}">${user.hasAccess ? 'Access Granted ‚úì' : 'Access Revoked ‚úó'}</span></p>
                    <div class="admin-actions">
                        ${user.hasAccess ? 
                            `<button class="btn-danger" onclick="revokeAccess('${user.email}')">Revoke Access</button>` :
                            `<button class="btn-success" onclick="grantAccess('${user.email}')">Grant Access</button>`
                        }
                        <button class="btn-delete" onclick="deleteUser('${user.email}')">Delete Permanently</button>
                    </div>
                `;
                userList.appendChild(div);
            });
        }

        function revokeAccess(email) {
            if (confirm('Revoke access for this user?')) {
                const users = JSON.parse(localStorage.getItem('users') || '{}');
                if (users[email]) {
                    users[email].hasAccess = false;
                    localStorage.setItem('users', JSON.stringify(users));
                    loadAdminPanel();
                    alert('Access revoked! ‚úì');
                }
            }
        }

        function grantAccess(email) {
            const users = JSON.parse(localStorage.getItem('users') || '{}');
            if (users[email]) {
                users[email].hasAccess = true;
                localStorage.setItem('users', JSON.stringify(users));
                loadAdminPanel();
                alert('Access granted! ‚úì');
            }
        }

        function deleteUser(email) {
            if (confirm('PERMANENTLY DELETE this user? This cannot be undone!')) {
                const users = JSON.parse(localStorage.getItem('users') || '{}');
                delete users[email];
                localStorage.setItem('users', JSON.stringify(users));
                loadAdminPanel();
                alert('User deleted permanently! ‚úì');
            }
        }

        function logout() {
            localStorage.removeItem('currentUser');
            currentUser = null;
            location.reload();
        }

        function startTest() {
            const testId = document.getElementById('testSelector').value;
            currentTest = generateTest(testId);
            currentQuestion = 0;
            answers = {};
            timeRemaining = 7200;
            
            document.getElementById('testSelectionScreen').classList.add('hidden');
            document.getElementById('testScreen').classList.remove('hidden');
            
            displayQuestion();
            createQuestionPalette();
            startTimer();
        }

        function generateTest(testId) {
            const questions = [];
            for (let i = 0; i < 120; i++) {
                const passageNum = Math.floor(i / 5) + 1;
                questions.push({
                    id: i + 1,
                    passage: `PASSAGE ${passageNum}\n\nIn the landmark judgment of State vs. Citizens Rights Forum (2024), the Supreme Court examined Article 19(1)(a) and 19(2) of the Constitution. The petitioners contended that Section 124A IPC (sedition) was being misused to suppress legitimate dissent and free speech. The Attorney General argued that national security concerns necessitated retention of the provision. In a 4:1 majority decision, the Court read down the provision while establishing strict guidelines for its invocation. The Court held that mere criticism of government policies cannot constitute sedition unless it incites violence or poses a clear and present danger to public order. This judgment has profound implications for interpretation of fundamental rights and balance between free speech and national security.`,
                    question: `Question ${i + 1}: Based on the passage above, which statement most accurately reflects the Supreme Court's reasoning?`,
                    options: [
                        'The Supreme Court completely struck down Section 124A as unconstitutional without any conditions',
                        'The Court upheld the sedition provision without any modifications or guidelines for its application',
                        'The Court interpreted the provision narrowly while imposing strict conditions for its application',
                        'The Court held that all forms of government criticism automatically constitute sedition under the law'
                    ],
                    correctAnswer: 2
                });
            }
            return { testId, questions };
        }

        function displayQuestion() {
            const q = currentTest.questions[currentQuestion];
            const card = document.getElementById('questionCard');
            
            card.innerHTML = `
                <div class="question-number">Question ${q.id} of 120</div>
                <div class="passage-box">
                    <p>${q.passage.replace(/\n/g, '<br>')}</p>
                </div>
                <div class="question-text">${q.question}</div>
                <div>
                    ${q.options.map((opt, idx) => `
                        <label class="option-label ${answers[q.id] === idx ? 'selected' : ''}" data-option="${idx}">
                            <input type="radio" name="q${q.id}" value="${idx}" ${answers[q.id] === idx ? 'checked' : ''}>
                            <span>${opt}</span>
                        </label>
                    `).join('')}
                </div>
            `;
            
            card.querySelectorAll('.option-label').forEach(label => {
                label.addEventListener('click', function() {
                    const radio = this.querySelector('input[type="radio"]');
                    radio.checked = true;
                    const optionIdx = parseInt(this.dataset.option);
                    saveAnswer(q.id, optionIdx);
                    card.querySelectorAll('.option-label').forEach(l => l.classList.remove('selected'));
                    this.classList.add('selected');
                });
            });
            
            document.getElementById('prevBtn').disabled = currentQuestion === 0;
            document.getElementById('nextBtn').disabled = currentQuestion === 119;
            updatePalette();
        }

        function saveAnswer(questionId, answerIndex) {
            answers[questionId] = answerIndex;
            updatePalette();
        }

        function createQuestionPalette() {
            const palette = document.getElementById('questionPalette');
            palette.innerHTML = '';
            
            for (let i = 0; i < 120; i++) {
                const btn = document.createElement('button');
                btn.className = 'palette-btn';
                btn.textContent = i + 1;
                btn.onclick = () => {
                    currentQuestion = i;
                    displayQuestion();
                };
                palette.appendChild(btn);
            }
        }

        function updatePalette() {
            const buttons = document.querySelectorAll('.palette-btn');
            buttons.forEach((btn, idx) => {
                btn.classList.remove('answered', 'current');
                if (idx === currentQuestion) btn.classList.add('current');
                if (answers[idx + 1] !== undefined) btn.classList.add('answered');
            });
        }

        function navigateQuestion(direction) {
            const newQ = currentQuestion + direction;
            if (newQ >= 0 && newQ < 120) {
                currentQuestion = newQ;
                displayQuestion();
            }
        }

        function startTimer() {
            const timerEl = document.getElementById('timer');
            timerInterval = setInterval(() => {
                timeRemaining--;
                const min = Math.floor(timeRemaining / 60);
                const sec = timeRemaining % 60;
                timerEl.textContent = `${min}:${sec.toString().padStart(2, '0')}`;
                
                if (timeRemaining === 600) {
                    timerEl.classList.add('warning');
                    alert('‚ö†Ô∏è Only 10 minutes left!');
                }
                
                if (timeRemaining <= 0) {
                    clearInterval(timerInterval);
                    alert('‚è∞ Time Up! Submitting test...');
                    submitTest();
                }
            }, 1000);
        }

        function submitTest() {
            if (timerInterval && !confirm('Submit test? You cannot change answers after submission!')) return;
            
            clearInterval(timerInterval);
            
            let correct = 0, incorrect = 0, unanswered = 0;
            
            currentTest.questions.forEach(q => {
                if (answers[q.id] === undefined) unanswered++;
                else if (answers[q.id] === q.correctAnswer) correct++;
                else incorrect++;
            });
            
            const score = correct - (incorrect * 0.25);
            const percentage = ((correct / 120) * 100).toFixed(2);
            const timeTaken = Math.floor((7200 - timeRemaining) / 60);
            
            document.getElementById('resultsContent').innerHTML = `
                <div style="text-align: center; padding: 40px;">
                    <div style="font-size: 64px; font-weight: 700; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin: 20px 0;">
                        ${score.toFixed(2)}
                    </div>
                    <p style="font-size: 20px; color: #666; margin-bottom: 40px;">Your Score</p>
                    
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; max-width: 600px; margin: 0 auto 40px;">
                        <div style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); padding: 24px; border-radius: 12px; color: white;">
                            <div style="font-size: 36px; font-weight: 700;">${correct}</div>
                            <div>Correct</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); padding: 24px; border-radius: 12px; color: white;">
                            <div style="font-size: 36px; font-weight: 700;">${incorrect}</div>
                            <div>Incorrect</div>
                        </div>
                        <div style="background: #f8f9fa; padding: 24px; border-radius: 12px;">
                            <div style="font-size: 36px; font-weight: 700; color: #333;">${unanswered}</div>
                            <div style="color: #666;">Unanswered</div>
                        </div>
                    </div>
                    
                    <div style="background: #f8f9fa; padding: 24px; border-radius: 12px; max-width: 600px; margin: 0 auto; text-align: left;">
                        <p style="margin: 12px 0;"><strong>Accuracy:</strong> ${percentage}%</p>
                        <p style="margin: 12px 0;"><strong>Total Questions:</strong> 120</p>
                        <p style="margin: 12px 0;"><strong>Time Taken:</strong> ${timeTaken} minutes</p>
                        <p style="margin: 12px 0;"><strong>Test:</strong> ${document.getElementById('testSelector').options[document.getElementById('testSelector').selectedIndex].text}</p>
                    </div>
                </div>
            `;
            
            document.getElementById('testScreen').classList.add('hidden');
            document.getElementById('resultsScreen').classList.remove('hidden');
            
            const scores = JSON.parse(localStorage.getItem('scores') || '[]');
            scores.push({
                user: currentUser.name,
                email: currentUser.email,
                test: document.getElementById('testSelector').options[document.getElementById('testSelector').selectedIndex].text,
                score: score,
                correct: correct,
                percentage: percentage,
                date: new Date().toISOString()
            });
            localStorage.setItem('scores', JSON.stringify(scores));
        }

        function backToTests() {
            document.getElementById('resultsScreen').classList.add('hidden');
            document.getElementById('testSelectionScreen').classList.remove('hidden');
        }
    </script>
</body>
</html>
